<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ejemplo de uso - NRD Data Access</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
        }
        .section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        button {
            margin: 5px;
            padding: 10px 15px;
            cursor: pointer;
        }
        pre {
            background: #f5f5f5;
            padding: 10px;
            border-radius: 3px;
            overflow-x: auto;
        }
        input {
            padding: 8px;
            margin: 5px;
            width: 200px;
        }
    </style>
</head>
<body>
    <h1>Ejemplo de uso - NRD Data Access</h1>

    <!-- Incluir la librería -->
    <script src="./dist/nrd-data-access.js"></script>

    <div class="section">
        <h2>Autenticación</h2>
        <input type="email" id="email" placeholder="Email" value="user@example.com">
        <input type="password" id="password" placeholder="Password" value="password123">
        <br>
        <button onclick="signIn()">Iniciar Sesión</button>
        <button onclick="signUp()">Registrar</button>
        <button onclick="signOut()">Cerrar Sesión</button>
        <button onclick="getCurrentUser()">Usuario Actual</button>
        <pre id="auth-result"></pre>
    </div>

    <div class="section">
        <h2>Clientes</h2>
        <button onclick="getAllClients()">Obtener Todos</button>
        <button onclick="createClient()">Crear Cliente</button>
        <pre id="clients-result"></pre>
    </div>

    <div class="section">
        <h2>Productos</h2>
        <button onclick="getAllProducts()">Obtener Todos</button>
        <button onclick="createProduct()">Crear Producto</button>
        <pre id="products-result"></pre>
    </div>

    <script>
        // Inicializar la librería
        const nrd = new NRDDataAccess();

        // Funciones de autenticación
        async function signIn() {
            try {
                const email = document.getElementById('email').value;
                const password = document.getElementById('password').value;
                const result = await nrd.auth.signIn(email, password);
                document.getElementById('auth-result').textContent = 
                    'Sesión iniciada: ' + JSON.stringify(result.user.email, null, 2);
            } catch (error) {
                document.getElementById('auth-result').textContent = 
                    'Error: ' + error.message;
            }
        }

        async function signUp() {
            try {
                const email = document.getElementById('email').value;
                const password = document.getElementById('password').value;
                const result = await nrd.auth.signUp(email, password);
                document.getElementById('auth-result').textContent = 
                    'Usuario registrado: ' + JSON.stringify(result.user.email, null, 2);
            } catch (error) {
                document.getElementById('auth-result').textContent = 
                    'Error: ' + error.message;
            }
        }

        async function signOut() {
            try {
                await nrd.auth.signOut();
                document.getElementById('auth-result').textContent = 'Sesión cerrada';
            } catch (error) {
                document.getElementById('auth-result').textContent = 
                    'Error: ' + error.message;
            }
        }

        function getCurrentUser() {
            const user = nrd.auth.getCurrentUser();
            document.getElementById('auth-result').textContent = 
                user ? 'Usuario: ' + user.email : 'No hay usuario autenticado';
        }

        // Funciones de clientes
        async function getAllClients() {
            try {
                const clients = await nrd.clients.getAll();
                document.getElementById('clients-result').textContent = 
                    JSON.stringify(clients, null, 2);
            } catch (error) {
                document.getElementById('clients-result').textContent = 
                    'Error: ' + error.message;
            }
        }

        async function createClient() {
            try {
                const clientId = await nrd.clients.create({
                    name: 'Cliente Ejemplo',
                    email: 'cliente@example.com',
                    phone: '+1234567890',
                    active: true
                });
                document.getElementById('clients-result').textContent = 
                    'Cliente creado con ID: ' + clientId;
            } catch (error) {
                document.getElementById('clients-result').textContent = 
                    'Error: ' + error.message;
            }
        }

        // Funciones de productos
        async function getAllProducts() {
            try {
                const products = await nrd.products.getAll();
                document.getElementById('products-result').textContent = 
                    JSON.stringify(products, null, 2);
            } catch (error) {
                document.getElementById('products-result').textContent = 
                    'Error: ' + error.message;
            }
        }

        async function createProduct() {
            try {
                const productId = await nrd.products.create({
                    name: 'Producto Ejemplo',
                    description: 'Descripción del producto',
                    price: 99.99,
                    currency: 'USD',
                    active: true
                });
                document.getElementById('products-result').textContent = 
                    'Producto creado con ID: ' + productId;
            } catch (error) {
                document.getElementById('products-result').textContent = 
                    'Error: ' + error.message;
            }
        }

        // Escuchar cambios de autenticación
        nrd.auth.onAuthStateChanged((user) => {
            console.log('Estado de autenticación cambió:', user ? user.email : 'No autenticado');
        });
    </script>
</body>
</html>

